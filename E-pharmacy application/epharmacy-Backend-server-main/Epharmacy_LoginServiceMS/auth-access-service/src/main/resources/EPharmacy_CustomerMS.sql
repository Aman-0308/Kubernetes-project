-- Drop the database if it exists
IF EXISTS (SELECT * FROM sys.databases WHERE name = 'EPHARMACY_CUSTOMERMS_DB')
BEGIN
    DROP DATABASE EPHARMACY_CUSTOMERMS_DB;
END
GO

-- Create the database
CREATE DATABASE EPHARMACY_CUSTOMERMS_DB;
GO

-- Use the database
USE EPHARMACY_CUSTOMERMS_DB;
GO

-- Create PRIME_PLANS table
CREATE TABLE PRIME_PLANS (
    PLAN_ID INT PRIMARY KEY,
    PLAN_NAME NVARCHAR(20),
    PLAN_DESCRIPTION NVARCHAR(255)
);
GO

-- Create CUSTOMER table
CREATE TABLE CUSTOMER (
    CUSTOMER_ID INT IDENTITY(1,1) PRIMARY KEY,
    CUSTOMER_NAME NVARCHAR(30) NOT NULL,
    CUSTOMER_EMAIL_ID NVARCHAR(30) NOT NULL,
    CONTACT_NUMBER NVARCHAR(10) NOT NULL,
    GENDER NVARCHAR(10),
    DATE_OF_BIRTH DATE,
    PASSWORD NVARCHAR(70) NOT NULL,
    PLAN_ID INT,
    PLAN_EXPIRY_DATE DATE,
    HEALTH_COINS INT,
    CONSTRAINT EPHARMACY_CUST_PLAN__FK FOREIGN KEY (PLAN_ID) REFERENCES PRIME_PLANS (PLAN_ID)
);
GO

-- Create CUSTOMER_ADDRESS table
CREATE TABLE CUSTOMER_ADDRESS (
    ADDRESS_ID INT IDENTITY(1,1) PRIMARY KEY,
    CUSTOMER_ID INT,
    ADDRESS_NAME NVARCHAR(15),
    ADDRESS_LINE1 NVARCHAR(30),
    ADDRESS_LINE2 NVARCHAR(30),
    AREA NVARCHAR(20),
    CITY NVARCHAR(17),
    STATE NVARCHAR(20),
    PINCODE INT,
    CONSTRAINT EPHARMACY_CUST_ADDR__FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER (CUSTOMER_ID)
);
GO

-- Create PASSWORD_HISTORY table
CREATE TABLE PASSWORD_HISTORY (
    ID INT IDENTITY(1,1) PRIMARY KEY,
    CUSTOMER_ID INT NOT NULL,
    PASSWORD NVARCHAR(70) NOT NULL,
    CONSTRAINT PASSWORD__FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER (CUSTOMER_ID)
);
GO

-- Insert data into PRIME_PLANS
INSERT INTO PRIME_PLANS (PLAN_ID, PLAN_NAME, PLAN_DESCRIPTION) VALUES 
(1, 'MONTHLY', 'For Rs. 199 get health coins equal to 10% on every payment using debit card or 15% (on credit card) for 1 month'),
(2, 'QUARTERLY', 'For Rs. 399 get health coins equal to 10% on every payment using debit card or 15% (on credit card) for 3 months'),
(3, 'YEARLY', 'For Rs. 699 get health coins equal to 10% on every payment using debit card or 15% (on credit card) for 1 year');
GO

-- Insert data into CUSTOMER
INSERT INTO CUSTOMER (CUSTOMER_NAME, CUSTOMER_EMAIL_ID, CONTACT_NUMBER, GENDER, DATE_OF_BIRTH, PASSWORD) VALUES 
('JOHN', 'john@abc.com', '8875632142', 'Male', '1999-09-09', '0f4dd6c67bc8c827a2b181bc763f9ab96166d8f50840fe1ae0bbc0e77464da2c'),
('STEVE', 'steve@abc.com', '9880253413', 'Male', '1998-09-02', '97661249431ccedba1711b78fb58eceb2c03054a07a7b684ad53048691b34435'),
('HARSHAL', 'harshal@abc.com', '8408871600', 'Male', '2000-09-09', '6d3d2d5f46ba476bf88b1775b9b3b8ec9ae42370a977e49ff908e1a1deb93ddc'),
('SHAHRUKH', 'shah@abc.com', '9548742258', 'Male', '2001-02-01', 'ae55f0d96478738c466f9ade2cd52cbddc08e49777fdefd702a30c872287504a'),
('ROSE', 'rose@abc.com', '9476888203', 'Female', '1999-12-24', '05939a21ed3550987916ded0eded53883d74785e2ad1794a5f570c58d7c6132e');
GO

-- Insert data into CUSTOMER_ADDRESS
INSERT INTO CUSTOMER_ADDRESS (CUSTOMER_ID, ADDRESS_NAME, ADDRESS_LINE1, ADDRESS_LINE2, AREA, CITY, STATE, PINCODE) VALUES 
(1, 'Home', '40A, Prestige Apartments', 'Gunjur Mohalla', 'Anand Vihar', 'Noida', 'Uttar Pradesh', 110029),
(1, 'Work', 'Reliance Industrial Area', 'Diamond City', 'Vasant Vihar', 'Delhi', 'Delhi', 110029),
(3, 'Home', 'A2/1, Indira Colonies', 'Lalvani Nagar', 'Baner', 'Pune', 'Maharashtra', 411037),
(3, 'Work', 'A705, AjayDeep Complex', 'Lalvani nagar', 'Kothrud', 'Pune', 'Maharashtra', 411037),
(5, 'Home', '309, Leo Janani Apartments', 'Lakshmikanth nagar', 'Rajouri Garden', 'Delhi', 'Delhi', 110027),
(4, 'Home', '187, Sumeru Nilaya', '6th Cross Road', 'Madegowda Circle', 'Mysore', 'Karnataka', 570016);
GO

-- Insert data into PASSWORD_HISTORY
INSERT INTO PASSWORD_HISTORY (CUSTOMER_ID, PASSWORD) VALUES 
(1, '0f4dd6c67bc8c827a2b181bc763f9ab96166d8f50840fe1ae0bbc0e77464da2c'),
(2, '97661249431ccedba1711b78fb58eceb2c03054a07a7b684ad53048691b34435'),
(3, '6d3d2d5f46ba476bf88b1775b9b3b8ec9ae42370a977e49ff908e1a1deb93ddc'),
(4, 'ae55f0d96478738c466f9ade2cd52cbddc08e49777fdefd702a30c872287504a'),
(5, '05939a21ed3550987916ded0eded53883d74785e2ad1794a5f570c58d7c6132e');
GO

-- Select data
SELECT * FROM PRIME_PLANS;
SELECT * FROM CUSTOMER;
SELECT * FROM CUSTOMER_ADDRESS;
SELECT * FROM PASSWORD_HISTORY;
GO
